import numpy as np
def s(x): return 1/(1+np.exp(-x))
X=np.array([[0,0],[0,1],[1,0],[1,1.]]); Y=np.array([[0],[1],[1],[0]])
w1=np.random.randn(2,3)*.1; b1=np.zeros(3); w2=np.random.randn(3,1)*.1; b2=np.zeros(1)
for _ in range(2000):
    a1=s(X.dot(w1)+b1); a2=s(a1.dot(w2)+b2)
    d2=(a2-Y)*a2*(1-a2); d1=d2.dot(w2.T)*a1*(1-a1)
    w2-=0.5*(a1.T.dot(d2))/4; b2-=0.5*d2.mean(0)
    w1-=0.5*(X.T.dot(d1))/4; b1-=0.5*d1.mean(0)
print(np.round(s(s(X.dot(w1)+b1).dot(w2)+b2),2))
